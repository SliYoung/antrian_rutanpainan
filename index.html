<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Antrian Kunjungan | Rutan Kelas IIB Painan</title>
<link rel="icon" type="image/png" href="https://i.imgur.com/GifnqrQ.png">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Inter',sans-serif;
  background:linear-gradient(135deg,#1e3a8a,#2563eb);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:20px
}
.container{
  background:#fff;
  width:100%;
  max-width:420px;
  border-radius:18px;
  box-shadow:0 25px 50px rgba(0,0,0,.18);
  padding:32px;
  animation:cardIn .8s ease
}
@keyframes cardIn{
  from{opacity:0;transform:scale(.95) translateY(30px)}
  to{opacity:1;transform:scale(1) translateY(0)}
}
.logo{text-align:center;margin-bottom:12px}
.logo img{
  width:80px;
  animation:float 3s ease-in-out infinite,glow 2.5s ease-in-out infinite
}
@keyframes float{
  0%,100%{transform:translateY(0)}
  50%{transform:translateY(-10px)}
}
@keyframes glow{
  0%,100%{filter:drop-shadow(0 0 0 rgba(37,99,235,.4))}
  50%{filter:drop-shadow(0 0 12px rgba(37,99,235,.8))}
}
.header{text-align:center;margin-bottom:24px}
.header h2{margin:6px 0 0;color:#1e3a8a;font-weight:700}
.header p{margin-top:6px;font-size:14px;color:#6b7280}
.form-group{margin-bottom:14px}
label{font-size:13px;font-weight:600;color:#374151}
input{
  width:100%;
  padding:12px 14px;
  margin-top:6px;
  border-radius:12px;
  border:1px solid #d1d5db;
  font-size:14px
}
input:focus{
  outline:none;
  border-color:#2563eb;
  box-shadow:0 0 0 4px rgba(37,99,235,.2)
}
button{
  width:100%;
  padding:15px;
  margin-top:18px;
  background:linear-gradient(135deg,#2563eb,#1d4ed8);
  border:none;
  border-radius:14px;
  color:#fff;
  font-size:15px;
  font-weight:600;
  cursor:pointer
}
button:disabled{background:#9ca3af;cursor:not-allowed}
.notice{
  margin-top:16px;
  padding:12px;
  border-radius:12px;
  background:#fee2e2;
  border:1px solid #ef4444;
  color:#991b1b;
  font-size:13px;
  font-weight:600;
  text-align:center
}
.result{
  margin-top:22px;
  background:#ecfdf5;
  border:1px solid #10b981;
  border-radius:14px;
  padding:16px;
  text-align:center;
  color:#065f46;
  font-weight:600;
  display:none
}
footer{text-align:center;font-size:12px;color:#9ca3af;margin-top:22px}

/* CETAK */
#printArea{
  display:none;
  font-family:Arial;
  max-width:280px;
  margin:auto
}
</style>
</head>
<body>

<div class="container">

  <div class="logo">
    <img src="https://i.imgur.com/GifnqrQ.png">
  </div>

  <div class="header">
    <h2>Antrian Kunjungan Online</h2>
    <p>Rumah Tahanan Kelas IIB Painan</p>
  </div>

  <div class="form-group">
    <label>Nama Pengunjung</label>
    <input type="text" id="nama">
  </div>

  <div class="form-group">
    <label>No WhatsApp</label>
    <input type="text" id="wa">
  </div>

  <div class="form-group">
    <label>Nama Warga Binaan</label>
    <input type="text" id="wbp">
  </div>

  <div class="form-group">
    <label>Tanggal Kunjungan</label>
    <input type="date" id="tanggal" readonly style="background:#f3f4f6">
  </div>

  <button id="btnDaftar" onclick="kirimData()">Daftar Antrian</button>

  <div class="notice">
    ‚ö†Ô∏è <strong>PERHATIAN</strong><br>
    Kunjungan:<br>
    <strong>Senin ‚Äì Jumat | 09.00 ‚Äì 15.00 WIB</strong><br>
    <span style="font-size:12px;font-weight:500">
      Screenshot nomor antrian untuk ditunjukkan kepada petugas
    </span>
  </div>

  <div class="result" id="hasil"></div>

  <button id="btnCetak" onclick="cetakAntrian()" style="display:none;margin-top:12px">
    üñ®Ô∏è Cetak Nomor Antrian
  </button>

  <footer>¬© 2025 Rutan Kelas IIB Painan</footer>
</div>

<!-- STRUK -->
<div id="printArea">
  <div style="text-align:center">
    <img src="https://i.imgur.com/GifnqrQ.png" width="46"><br>
    <strong>RUTAN KELAS IIB PAINAN</strong><br>
    Nomor Antrian Kunjungan
    <hr>
    Nama: <span id="pNama"></span><br>
    WBP: <span id="pWbp"></span><br>
    Tanggal: <span id="pTanggal"></span>
    <hr>
    <div style="font-size:42px;font-weight:bold" id="pAntrian"></div>
    <hr>
    Harap datang sesuai jadwal
  </div>
</div>

<script>
const scriptURL = "https://script.google.com/macros/s/AKfycbxMflUwnGdQpbJeO8TDj-y0ZLvQyiVI8ATmPN_0akcQ9SRRZSbdFYbWKnns3_cIC5gY/exec";

function kirimData(){
  if(btnDaftar.disabled) return;

  const data={
    nama:nama.value,
    wa:wa.value,
    wbp:wbp.value,
    tanggal:tanggal.value
  };

  if(!data.nama||!data.wa||!data.wbp||!data.tanggal){
    alert("Semua data wajib diisi");
    return;
  }

  btnDaftar.disabled=true;
  btnDaftar.innerText="Mengambil Nomor...";

  fetch(scriptURL,{
    method:"POST",
    body:JSON.stringify(data)
  })
  .then(r=>r.json())
  .then(r=>{
    hasil.style.display="block";
    hasil.innerHTML=`
      Nomor Antrian Anda:
      <h2 style="margin:8px 0">${r.antrian}</h2>
      <div style="font-size:13px">
        üìÖ Tanggal Kunjungan: <strong>${data.tanggal}</strong>
      </div>
    `;

    pNama.innerText=data.nama;
    pWbp.innerText=data.wbp;
    pTanggal.innerText=data.tanggal;
    pAntrian.innerText=r.antrian;

    btnDaftar.innerText="Antrian Sudah Diambil";
    btnCetak.style.display="block";
  })
  .catch(()=>{
    alert("Gagal mengambil antrian");
    btnDaftar.disabled=false;
    btnDaftar.innerText="Daftar Antrian";
  });
}

function cetakAntrian(){
  const isi=document.getElementById("printArea").innerHTML;
  const halaman=document.body.innerHTML;
  document.body.innerHTML=isi;
  window.print();
  document.body.innerHTML=halaman;
  location.reload();
}

document.addEventListener("DOMContentLoaded",()=>{
  const d=new Date();
  tanggal.value=d.toISOString().split("T")[0];
});
</script>

</body>
</html>
